---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```


[![Build Status](https://travis-ci.org/kota7/striprtf.svg?branch=master)](https://travis-ci.org/kota7/striprtf)
[![CRAN Status](https://www.r-pkg.org/badges/version/striprtf)](https://www.r-pkg.org/badges/version/striprtf)
[![](http://cranlogs.r-pkg.org/badges/striprtf)](https://cran.r-project.org/package=striprtf)


# striprtf: Extract Text from RTF (Rich Text Format) File


## Installation

This package is now on CRAN.

```R
install.packages("striprtf")
```

Alternatively, install development version from Github using `devtools` library.
```R
devtools::install_github("kota7/striprtf")
```


## Usage

The package exports two main functions: 

- `read_rtf` takes a path to a Rich Text Format (RTF) file and extracts plain text out of it.
- `strip_rtf` does the same with string input instead of file path.

```{r}
library(striprtf)
x <- read_rtf(system.file("extdata/king.rtf", package = "striprtf"))
head(x)
```

The package has also been tested with documents in East Asian languages.
```{r}
read_rtf(system.file("extdata/amenimo.rtf", package = "striprtf"))
read_rtf(system.file("extdata/mean.rtf", package = "striprtf"))
```


## Important Change in the Function Names

From ver 0.3.1, the functions are renamed as follows:

- `striprtf` --> `read_rtf`
- `rtf2text` --> `strip_rtf`

See NEWS for other updates.


## Tables (v0.4.1+)

Supports tables in documents.  Use `row_start`, `row_end`, `cell_end` arguments
to adjust the format the tables.
Suppports line breaks (and other special characters) within cells.

The parser is made robust from v0.4.5.  
Tested with files generated by Microsoft Word, Google Doc, and Libre Office Writer.

```{r}
# example file added at v0.4.2
read_rtf(system.file("extdata/shakespeare.rtf", package = "striprtf"),
         row_start = "**", row_end = "", cell_end = " --- ")
```

Note:

- No support for nested tables
- No support for merged cells

## References

- [Stack overflow thread](http://stackoverflow.com/a/188877) where the algorithm has been discussed.
- [Gilson Filho's implementation for python 3](https://gist.github.com/gilsondev/7c1d2d753ddb522e7bc22511cfb08676)
- [RTF specification 1.5](http://www.biblioscape.com/rtf15_spec.htm)
- [RTF specification latest](https://www.microsoft.com/en-us/download/details.aspx?id=10725)



